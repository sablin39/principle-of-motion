
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<title>
9.2 Mapping</title>
<script language="JavaScript1.2" src="dui.js"></script>
<script language="JavaScript1.2" src="chaptertoc.js"></script>
<script type="text/JavaScript" language="JavaScript1.2" src="recommendMe.js"></script>
<!--[if lt IE 7.]>
<script defer type="text/javascript" src="/pngfix.js"></script>
<![endif]-->
<link rel="stylesheet" href="zapplication.css" type="text/css" />
<link rel="stylesheet" href="zshowkeywords.css" type="text/css" />
<link rel="stylesheet" type="text/css" href="ns.content.books24x7.css" />
</head>
<body leftmargin="20" topmargin="5" rightmargin="0" bgcolor="#FFFFFF">
<a href="#content" tabindex="1"><img src="images/_.gif" width="1" height="1" alt="Skip Navigation" title="Skip Navigation" border="0" /></a><div style="position:absolute;display:none;" id="thebubblediv"> <?xml version='1.0' encoding='utf-8'?><table id="bubbledown" border="0" cellpadding="0" cellspacing="0" xmlns:dc="http://purl.org/dc/elements/1.0/"><tr><td align="left" class="b24-bubbleoutside" background="images/di_legend_nw_d.gif" width="32" height="32"><img src="images/_.gif" alt="" border="0" height="32" width="32" /></td><td align="center" class="b24-bubbleoutside" background="images/di_legend_n_d.gif" width="165" height="32"><img src="images/_.gif" alt="" border="0" height="32" width="165" /></td><td align="right" class="b24-bubbleoutside" background="images/di_legend_ne_d.gif" width="32" height="32"><img src="images/_.gif" alt="" border="0" height="32" width="32" /></td></tr><tr><td class="b24-bubbleoutside" background="images/di_legend_w_d.gif" width="32" height="1"><img src="images/_.gif" alt="" border="0" height="1" width="32" /></td><td class="b24-boxcontent" bgcolor="#ffffff"><table border="0" cellpadding="0" cellspacing="5" width="195" id="bubbledownicons"><tr id="d0"><td colspan="2"><span class="b24-bubblelegendheader">Icon Legend</span></td></tr><tr valign="TOP" id="d1"><td><img width="16" height="16" border="0" src="images/i_bookreview.gif" /></td><td><span class="b24-bubblelegendtext">Content type is a review.</span></td></tr><tr valign="TOP" id="d2"><td><img width="16" height="16" border="0" src="images/i_summary.gif" /></td><td><span class="b24-bubblelegendtext">Content type is a summary.</span></td></tr><tr valign="TOP" id="d4"><td><img width="16" height="16" border="0" src="images/i_blueprint.gif" /></td><td><span class="b24-bubblelegendtext">Content type is an ExecBlueprint.</span></td></tr><tr valign="TOP" id="d8"><td><img width="16" height="16" border="0" src="images/i_reportb.gif" /></td><td><span class="b24-bubblelegendtext">Content type is a report.</span></td></tr><tr valign="TOP" id="d16"><td><img width="16" height="16" border="0" src="images/i_video.gif" /></td><td align="LEFT"><span class="b24-bubblelegendtext">Content type is video program.  Video programs are viewed using Adobe Flash 8 or newer.</span></td></tr><tr valign="TOP" id="d524288"><td><img width="16" height="16" border="0" src="images/i_recorded.gif" /></td><td align="LEFT"><span class="b24-bubblelegendtext">Content type is a recorded session</span></td></tr><tr valign="TOP" id="d1048576"><td><img width="16" height="16" border="0" src="images/i_journal_b.gif" /></td><td align="LEFT"><span class="b24-bubblelegendtext">Content type is a journal.</span></td></tr><tr valign="TOP" id="d2097152"><td><img width="16" height="16" border="0" src="images/i_newsletter.gif" /></td><td align="LEFT"><span class="b24-bubblelegendtext">Content type is a newsletter.</span></td></tr><tr valign="TOP" id="d32"><td><img width="16" height="16" border="0" src="images/i_companion.gif" /></td><td><span class="b24-bubblelegendtext">Includes companion files which can be downloaded by clicking on the links found at the bottom of the launch page for programs. </span></td></tr><tr valign="TOP" id="d64"><td><img width="16" height="16" border="0" src="images/i_book.gif" /></td><td><span class="b24-bubblelegendtext">Title is in personal folders</span></td></tr><tr valign="TOP" id="d128"><td><img width="16" height="16" border="0" src="images/i_notes.gif" /></td><td><span class="b24-bubblelegendtext">Contains a bookmark which can be found by clicking the link on the Table of Contents page. </span></td></tr><tr valign="TOP" id="d256"><td><img width="16" height="16" border="0" src="images/i_corporatenotes.gif" /></td><td><span class="b24-bubblelegendtext">Corporate Annotations</span></td></tr><tr valign="TOP" id="d2048"><td><img width="16" height="16" border="0" src="images/i_cdcontent.gif" /></td><td><span class="b24-bubblelegendtext">Includes supplemental CD content which can be downloaded by clicking the link found on the Table of Contents page</span></td></tr><tr valign="TOP" id="d4096"><td><img width="16" height="16" border="0" src="images/i_sound.gif" /></td><td><span class="b24-bubblelegendtext">Offers an audio MP3 file which can be retrieved by clicking the audio download tool. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="d16384"><td><img width="16" height="16" border="0" src="images/i_lit.gif" /></td><td><span class="b24-bubblelegendtext">Offers a downloadable Microsoft Reader file which can be retrieved by clicking the download tool. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="d32768"><td><img width="16" height="16" border="0" src="images/i_palm.gif" /></td><td><span class="b24-bubblelegendtext">Offers a downloadable Palm file which can be retrieved by clicking the download tool. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="d8192"><td><img width="16" height="16" border="0" src="images/i_pdf.gif" /></td><td><span class="b24-bubblelegendtext">Offers a full text Adobe PDF which can be retrieved by clicking the download tool. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="d65536"><td><img width="16" height="16" border="0" src="images/i_chapterpdf.gif" /></td><td><span class="b24-bubblelegendtext">Supports downloadable chapters which can only be downloaded by clicking the download tool when viewing a content page. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="d131072"><td><img width="16" height="16" border="0" src="images/i_starchapterpdf.gif" /></td><td><span class="b24-bubblelegendtext">Includes Chapters to Go. These premium downloadable chapters are retrieved by clicking the download tool. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="d16777216"><td><img width="16" height="16" border="0" src="images/i_ppt.gif" /></td><td><span class="b24-bubblelegendtext">Offers a downloadable Microsoft PowerPoint file which can be retrieved by clicking the download tool.</span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="d262144"><td><img width="16" height="16" border="0" src="images/i_bookintopic.gif" /></td><td><span class="b24-bubblelegendtext">Title is in corporate topics</span></td></tr><tr valign="TOP" id="d4194304"><td><img width="16" height="16" border="0" src="images/i_checkmark_yes.gif" /></td><td><span class="b24-bubblelegendtext">I recommend this title.  If many users recommend this title a Yes! seal will appear on top left corner of the title graphic. </span><img width="26" height="27" border="0" src="images/best_reads_sm.seal.png" /></td></tr><tr valign="TOP" id="d8388608"><td><img width="16" height="16" border="0" src="images/i_checkmark_no.gif" /></td><td><span class="b24-bubblelegendtext">I do not recommend this title.</span></td></tr><tr valign="TOP" id="d33554432"><td><img width="16" height="16" border="0" src="images/i_mp4.gif" /></td><td><span class="b24-bubblelegendtext">Offers a MP4 video file which can be retrieved by clicking on the MP4 Video Download link in the Play Options box.</span></td></tr></table></td><td class="b24-bubbleoutside" background="images/di_legend_e_d.gif" width="32" height="1"><img src="images/_.gif" alt="" border="0" height="1" width="32" /></td></tr><tr><td class="b24-bubbleoutside" align="left" background="images/di_legend_sw_d.gif" width="32" height="70"><img src="images/_.gif" alt="" border="0" height="70" width="32" /></td><td class="b24-bubbleoutside" align="center" background="images/di_legend_s_d.gif" width="165" height="70"><img src="images/_.gif" alt="" border="0" height="70" width="165" /></td><td class="b24-bubbleoutside" align="right" background="images/di_legend_se_d.gif" width="32" height="70"><img src="images/_.gif" alt="" border="0" height="70" width="32" /></td></tr></table><table id="bubbleup" border="0" cellpadding="0" cellspacing="0" xmlns:dc="http://purl.org/dc/elements/1.0/"><tr><td align="LEFT" class="b24-bubbleoutside" background="images/di_legend_nw.gif" width="32" height="71" alt="" border="0"><img src="images/_.gif" alt="" border="0" height="71" width="32" /></td><td align="CENTER" class="b24-bubbleoutside" background="images/di_legend_n.gif" width="165" height="71" alt="" border="0"><img src="images/_.gif" alt="" border="0" height="71" width="165" /></td><td align="RIGHT" class="b24-bubbleoutside" background="images/di_legend_ne.gif" width="32" height="71" alt="" border="0"><img src="images/_.gif" alt="" border="0" height="71" width="32" /></td></tr><tr><td class="b24-bubbleoutside" background="images/di_legend_w.gif" width="32" height="1" alt="" border="0"><img src="images/_.gif" alt="" border="0" height="1" width="32" /></td><td class="b24-boxcontent" bgcolor="#ffffff"><table border="0" cellpadding="0" cellspacing="5" width="195" id="bubbleupicons"><tr id="u0"><td colspan="2"><span class="b24-bubblelegendheader">Icon Legend</span></td></tr><tr valign="TOP" id="u1"><td><img width="16" height="16" border="0" src="images/i_bookreview.gif" /></td><td><span class="b24-bubblelegendtext">Content type is a review.</span></td></tr><tr valign="TOP" id="u2"><td><img width="16" height="16" border="0" src="images/i_summary.gif" /></td><td><span class="b24-bubblelegendtext">Content type is a summary.</span></td></tr><tr valign="TOP" id="u4"><td><img width="16" height="16" border="0" src="images/i_blueprint.gif" /></td><td><span class="b24-bubblelegendtext">Content type is an ExecBlueprint.</span></td></tr><tr valign="TOP" id="u8"><td><img width="16" height="16" border="0" src="images/i_reportb.gif" /></td><td><span class="b24-bubblelegendtext">Content type is a report.</span></td></tr><tr valign="TOP" id="u16"><td><img width="16" height="16" border="0" src="images/i_video.gif" /></td><td align="LEFT"><span class="b24-bubblelegendtext">Content type is video program.  Video programs are viewed using Adobe Flash 8 or newer.</span></td></tr><tr valign="TOP" id="u524288"><td><img width="16" height="16" border="0" src="images/i_recorded.gif" /></td><td align="LEFT"><span class="b24-bubblelegendtext">Content type is a recorded session</span></td></tr><tr valign="TOP" id="u1048576"><td><img width="16" height="16" border="0" src="images/i_journal_b.gif" /></td><td align="LEFT"><span class="b24-bubblelegendtext">Content type is a journal.</span></td></tr><tr valign="TOP" id="u2097152"><td><img width="16" height="16" border="0" src="images/i_newsletter.gif" /></td><td align="LEFT"><span class="b24-bubblelegendtext">Content type is a newsletter.</span></td></tr><tr valign="TOP" id="u32"><td><img width="16" height="16" border="0" src="images/i_companion.gif" /></td><td><span class="b24-bubblelegendtext">Includes companion files which can be downloaded by clicking on the links found at the bottom of the launch page for programs. </span></td></tr><tr valign="TOP" id="u64"><td><img width="16" height="16" border="0" src="images/i_book.gif" /></td><td><span class="b24-bubblelegendtext">Title is in personal folders</span></td></tr><tr valign="TOP" id="u128"><td><img width="16" height="16" border="0" src="images/i_notes.gif" /></td><td><span class="b24-bubblelegendtext">Contains a bookmark which can be found by clicking the link on the Table of Contents page. </span></td></tr><tr valign="TOP" id="u256"><td><img width="16" height="16" border="0" src="images/i_corporatenotes.gif" /></td><td><span class="b24-bubblelegendtext">Corporate Annotations</span></td></tr><tr valign="TOP" id="u2048"><td><img width="16" height="16" border="0" src="images/i_cdcontent.gif" /></td><td><span class="b24-bubblelegendtext">Includes supplemental CD content which can be downloaded by clicking the link found on the Table of Contents page</span></td></tr><tr valign="TOP" id="u4096"><td><img width="16" height="16" border="0" src="images/i_sound.gif" /></td><td><span class="b24-bubblelegendtext">Offers an audio MP3 file which can be retrieved by clicking the audio download tool. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="u16384"><td><img width="16" height="16" border="0" src="images/i_lit.gif" /></td><td><span class="b24-bubblelegendtext">Offers a downloadable Microsoft Reader file which can be retrieved by clicking the download tool. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="u32768"><td><img width="16" height="16" border="0" src="images/i_palm.gif" /></td><td><span class="b24-bubblelegendtext">Offers a downloadable Palm file which can be retrieved by clicking the download tool. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="u8192"><td><img width="16" height="16" border="0" src="images/i_pdf.gif" /></td><td><span class="b24-bubblelegendtext">Offers a full text Adobe PDF which can be retrieved by clicking the download tool. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="u65536"><td><img width="16" height="16" border="0" src="images/i_chapterpdf.gif" /></td><td><span class="b24-bubblelegendtext">Supports downloadable chapters which can only be downloaded by clicking the download tool when viewing a content page. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="u131072"><td><img width="16" height="16" border="0" src="images/i_starchapterpdf.gif" /></td><td><span class="b24-bubblelegendtext">Includes Chapters to Go. These premium downloadable chapters are retrieved by clicking the download tool. </span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="u16777216"><td><img width="16" height="16" border="0" src="images/i_ppt.gif" /></td><td><span class="b24-bubblelegendtext">Offers a downloadable Microsoft PowerPoint file which can be retrieved by clicking the download tool.</span><img width="12" height="12" border="0" src="images/dui_tool_download.gif" /></td></tr><tr valign="TOP" id="u262144"><td><img width="16" height="16" border="0" src="images/i_bookintopic.gif" /></td><td><span class="b24-bubblelegendtext">Title is in corporate topics</span></td></tr><tr valign="TOP" id="u4194304"><td><img width="16" height="16" border="0" src="images/i_checkmark_yes.gif" /></td><td><span class="b24-bubblelegendtext">I recommend this title.  If many users recommend this title a Yes! seal will appear on top left corner of the title graphic. </span><img width="26" height="27" border="0" src="images/best_reads_sm.seal.png" /></td></tr><tr valign="TOP" id="u8388608"><td><img width="16" height="16" border="0" src="images/i_checkmark_no.gif" /></td><td><span class="b24-bubblelegendtext">I do not recommend this title.</span></td></tr><tr valign="TOP" id="u33554432"><td><img width="16" height="16" border="0" src="images/i_mp4.gif" /></td><td><span class="b24-bubblelegendtext">Offers a MP4 video file which can be retrieved by clicking on the MP4 Video Download link in the Play Options box.</span></td></tr></table></td><td class="b24-bubbleoutside" background="images/di_legend_e.gif" width="32" height="1"><img src="images/_.gif" alt="" border="0" height="1" width="32" /></td></tr><tr><td class="b24-bubbleoutside" align="LEFT" background="images/di_legend_sw.gif" width="32" height="32" alt="" border="0"><img src="images/_.gif" alt="" border="0" height="32" width="32" /></td><td class="b24-bubbleoutside" align="CENTER" background="images/di_legend_s.gif" width="165" height="32" alt="" border="0"><img src="images/_.gif" alt="" border="0" height="32" width="165" /></td><td class="b24-bubbleoutside" align="RIGHT" background="images/di_legend_se.gif" width="32" height="32" alt="" border="0"><img src="images/_.gif" alt="" border="0" height="32" width="32" /></td></tr></table> </div> <div id="overlay" class="b24-download_overlay" onclick="javascript:SunDown();"></div> <div id="download" class="b24-download_bubble"></div> <?xml version='1.0' encoding='utf-8'?><span id="b24-booktype-10749" style="display:none" xmlns:dc="http://purl.org/dc/elements/1.0/">0</span><div class="b24-bookmeta" xmlns:dc="http://purl.org/dc/elements/1.0/"><table border="0" cellpadding="0" cellspacing="2" class="b24-folderbook1"><tr><td valign="TOP" align="LEFT" height="109" width="98"><a border="0" href="1.html"><div><img border="0" align="Left" id="COVERIMAGE10749" src="0262033275.gif" height="99" width="88" alt="The Coverimage" title="The Coverimage" /></div><br /></a></td><td width="2" valign="TOP" height="109"></td><td valign="Top" align="Left"><table border="0" cellpadding="0" cellspacing="4" width="100%" height="109"><tr><td valign="TOP" align="Left" nowrap="1" colspan="2"><a border="0"><span id="b24-chaptertitle" class="b24-bookchaptertitle">Chapter 9 - 
 Bayesian Methods</span></a></td></tr><tr><td valign="Top" align="Left" colspan="2"><span id="b24-booktitle-10749">Principles of Robot Motion: Theory, Algorithms, and Implementation</span></td></tr><tr><td valign="TOP" align="Left" colspan="2"><span id="b24-bookauthor-10749" class="b24-bookauthor">by <a class="b24-bookauthor">Howie Choset</a> et al.</span> </td></tr><tr><td valign="TOP" align="Left" colspan="2"><a><span id="b24-bookimprint-10749" class="b24-bookimprint">The MIT Press</span></a><span id="b24-bookrights-10749" class="b24-bookcwdate"> © 2005</span> </td></tr><tr><td valign="TOP" align="Left" colspan="2" id="ID10749"></td></tr><tr><td colspan="2" valign="TOP" align="LEFT"></td></tr></table></td></tr><tr><td valign="TOP" align="Center" colspan="3" height="10"><img src="images/_.gif" width="1" border="0" alt="" height="10" /></td></tr></table></div>
<script language="JavaScript">
<!--
function Next(item) {
var cm = new Array(24,34,50,41,9,55,87,35,24,28,47,7,7,3,15)
var a1 = new Array(4,12,11)
var a2 = new Array(1,9,13)
var a3 = new Array(10,0,14)
var a4 = new Array(3,8,2)
var a5 = new Array(6,5,7)
var b1="00"+cm[a1[item]]; b1= b1.substr(b1.length-2,2)
var b2="00"+cm[a2[item]]; b2= b2.substr(b2.length-2,2)
var b3="00"+cm[a3[item]]; b3= b3.substr(b3.length-2,2)
var b4="00"+cm[a4[item]]; b4= b4.substr(b4.length-2,2)
var b5="00"+cm[a5[item]]; b5= b5.substr(b5.length-2,2)
var h ='viewer.asp?bookid=10749\46chunkid='+b1+b2+b3+b4+b5;
this.location=h}
//  -->
</script>
<?xml version='1.0' encoding='utf-8'?><table cellspacing="0" cellpadding="0" border="0" width="100%"><tr><td align="Center"><table cellspacing="5" cellpadding="0" border="0" width="85%"></table></td></tr><tr><td bgcolor="#000000"><img src="images/transdot.gif" width="1" height="1" border="0" alt="" /></td></tr></table><table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td colspan="3" height="5"><img src="images/_.gif" width="1" alt="" border="0" height="5" /></td>
</tr>
<tr>
<td class="b24-chunknavigate" width="25%" align="left"><a border="0" accesskey="P" href="54.html"><img src="images/arrow_readprevious.gif" width="94" height="22" hspace="0" alt="Previous Section" title="Previous Section" border="0" /></a></td>
<td class="b24-chunknavigate" width="75%" align="center">
<table cellpadding="0" cellspacing="0" border="0">
</table>
</td>
<td class="b24-chunknavigate" width="25%" align="right"><a border="0" href="viewer.asp?bookid=10749&amp;chunkid=703155035"><img width="1" height="1" hspace="1" border="0" alt="" src="images/_.gif" /></a><a border="0" accesskey="N" href="56.html"><img src="images/arrow_readnext.gif" width="94" height="22" hspace="0" alt="Next Section" title="Next Section" border="0" /></a></td>
</tr>
<tr>
<td colspan="3" height="5"><img src="images/_.gif" width="1" alt="" border="0" height="5" /></td>
</tr>
</table>
<div xmlns:esi="i.am.akamai"><!--Bypass:First Viewer Page:pdf download link: Time:Sat, 24 Jan 2009 10:27:10 UTC--><div><!--XML Creation Time:Sat, 24 Jan 2009 10:27:12 UTC-->
<div class="chapter">
<a name="ch091C14020F-F9F5-4415-973A-D906072C1A72"></a>
<div class="section">
<h2 class="first-section-title">
<a name="818"></a><a name="ch09lev1sec21C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="section-titlelabel">9.2 </span>Mapping</h2>
<p class="first-para">
<a name="819"></a><a name="IDX-3281C14020F-F9F5-4415-973A-D906072C1A72"></a>In <a href="48.html" target="_parent" class="chapterjump">chapter 8</a> we learned how to use a Kalman filter for acquiring a map of the environment. The assumption there was that the robot can identify landmarks in the environment and that the posterior about the location of the robot and the landmarks can be represented by a Gaussian distribution. In this section we consider probabilistic forms of mapping that-similarly to probabilistic localization-allow representation of arbitrary posteriors about the state of the environment and the location of the robot during mapping.</p>
<p class="para">To map an environment, a robot has to cope with two types of sensor noise: noise in perception (e.g., range measurements), and noise in odometry (e.g., wheel encoders). Because of the latter, the problem of mapping creates an inherent localization problem. The mobile robot mapping problem is therefore often referred to as the <i class="emphasis">concurrent mapping and localization problem (CML)</i> [277], or as the <i class="emphasis">simultaneous localization and mapping problem</i> [99,128] (see also <a href="48.html" target="_parent" class="chapterjump">chapter 8</a>). As in <a href="48.html" target="_parent" class="chapterjump">chapter 8</a> we will use the acronym SLAM when referring to the latter. In fact, errors in odometry render the errors of individual features in the map dependent even if the measurement noise is independent, which suggests that SLAM is a high-dimensional statistical estimation problem, often with tens of thousands of dimensions. In this chapter we approach this problem in two steps. First we concentrate on the question of how to build maps given the location of the robot is known. Afterward we relax this assumption and describe a recently developed technique for SLAM.</p>
<div class="section">
<h3 class="sect3-title">
<a name="820"></a><a name="ch09lev2sec61C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="section-titlelabel">9.2.1 </span>Mapping with Known Locations of the Robot</h3>
<p class="first-para">A very popular, probabilistic approach to represent the environment is the so-called occupancy probability grid pioneered by Elfes and Moravec in the 80s [325]. Occupancy probability grids are approximative. Each cell <i class="emphasis">m<sub>l</sub></i> of such a two-dimensional grid <i class="emphasis">m</i> stores the probability <i class="emphasis">P</i>(<i class="emphasis">m<sub>l</sub></i> | <i class="emphasis">x</i>(1: <i class="emphasis">k</i>), <i class="emphasis">y</i>(1: <i class="emphasis">k</i>)) that the place in the environment corresponding to <i class="emphasis">m<sub>l</sub></i> is occupied given the observations <i class="emphasis">y</i>(1: <i class="emphasis">k</i>) = <i class="emphasis">y</i>(1),...,<i class="emphasis">y</i>(<i class="emphasis">k</i>) and all locations of the robot <i class="emphasis">x</i>(1: <i class="emphasis">k</i>) = <i class="emphasis">x</i>(1),...,<i class="emphasis">x</i>(<i class="emphasis">k</i>) at the corresponding points in time. Because of their probabilistic nature, occupancy probability grids can be updated easily based on sensory input.</p>
<p class="para">Occupancy probability grids seek to find the map <i class="emphasis">m</i> that maximizes <i class="emphasis">P</i>(<i class="emphasis">m</i> | <i class="emphasis">x</i>(1: <i class="emphasis">k</i>), <i class="emphasis">y</i>(1: <i class="emphasis">k</i>)). If we apply Bayes rule using <i class="emphasis">x</i>(1: <i class="emphasis">k</i>) and <i class="emphasis">y</i>(1: <i class="emphasis">k</i> ? 1) as background knowledge, we obtain</p>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.26)&nbsp;</span></td><td valign="top"><img src="figu328_1.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">
<a name="821"></a><a name="IDX-3291C14020F-F9F5-4415-973A-D906072C1A72"></a>If we assume that <i class="emphasis">y</i>(<i class="emphasis">k</i>) is independent from <i class="emphasis">x</i>(1 : <i class="emphasis">k</i> ? 1) and <i class="emphasis">y</i>(1 : <i class="emphasis">k</i> ? 1) given we know <i class="emphasis">m</i>, then the right side of this equation can be simplified to</p>
<div class="equation" mathml="yes">
<a name="822"></a><a name="ch09eqn271C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.27)&nbsp;</span></td><td valign="top"><img src="figu329_1.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">We now again apply Bayes rule to determine</p>
<div class="equation" mathml="yes">
<a name="823"></a><a name="ch09eqn281C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.28)&nbsp;</span></td><td valign="top"><img src="figu329_2.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">If we insert <a class="internaljump" href="#ch09eqn281C14020F-F9F5-4415-973A-D906072C1A72">(9.28)</a> into <a class="internaljump" href="#ch09eqn271C14020F-F9F5-4415-973A-D906072C1A72">(9.27)</a> and since <i class="emphasis">x</i>(<i class="emphasis">k</i>) does not carry any information about <i class="emphasis">m</i> if there is no observation <i class="emphasis">y</i>(<i class="emphasis">k</i>), we obtain</p>
<div class="equation" mathml="yes">
<a name="824"></a><a name="ch09eqn291C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.29)&nbsp;</span></td><td valign="top"><img src="figu329_3.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">If we exploit the fact that each <i class="emphasis">m<sub>l</sub></i> is a binary variable, we derive the following equation for the posterior probability that all cells of <i class="emphasis">m</i> are free in an analogous way.</p>
<div class="equation" mathml="yes">
<a name="825"></a><a name="ch09eqn301C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.30)&nbsp;</span></td><td valign="top"><img src="figu329_4.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">where <i class="emphasis">m</i> denotes the complement of <i class="emphasis">m</i>. By dividing <a class="internaljump" href="#ch09eqn291C14020F-F9F5-4415-973A-D906072C1A72">(9.29)</a> by <a class="internaljump" href="#ch09eqn301C14020F-F9F5-4415-973A-D906072C1A72">(9.30)</a>, we obtain</p>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.31)&nbsp;</span></td><td valign="top"><img src="figu329_5.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">Finally, we use the fact that <i class="emphasis">P</i>(<i class="emphasis">A</i>) = 1 ? <i class="emphasis">P</i>(<i class="emphasis">A</i>) and obtain the following equation:</p>
<div class="equation" mathml="yes">
<a name="826"></a><a name="ch09eqn321C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.32)&nbsp;</span></td><td valign="top"><img src="figu329_6.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">If we define</p>
<div class="equation" mathml="yes">
<a name="827"></a><a name="ch09eqn331C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.33)&nbsp;</span></td><td valign="top"><img src="figu329_7.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">
<a name="828"></a><a name="IDX-3301C14020F-F9F5-4415-973A-D906072C1A72"></a><a class="internaljump" href="#ch09eqn321C14020F-F9F5-4415-973A-D906072C1A72">(9.32)</a> turns into</p>
<div class="equation" mathml="yes">
<a name="829"></a><a name="ch09eqn341C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.34)&nbsp;</span></td><td valign="top"><img src="figu330_1.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">The corresponding log Odds representation of <a class="internaljump" href="#ch09eqn341C14020F-F9F5-4415-973A-D906072C1A72">(9.34)</a> is</p>
<div class="equation" mathml="yes">
<a name="830"></a><a name="ch09eqn351C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.35)&nbsp;</span></td><td valign="top"><img src="figu330_2.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">Please note that this equation also has a recursive structure similar to that of the recursive Bayesian filtering scheme described in <a href="54.html#755" target="_parent" class="chapterjump">Section 9.1</a>. To incorporate a new scan into a given map we multiply its Odds ratio with the Odds ratio of a local map constructed from the most recent scan and divide it by the Odds ratio of the prior. Often it is assumed that the prior probability of <i class="emphasis">m</i> is 0.5. In this case the prior can be canceled so that <a class="internaljump" href="#ch09eqn351C14020F-F9F5-4415-973A-D906072C1A72">(9.35)</a> simplifies to</p>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.36)&nbsp;</span></td><td valign="top"><img src="figu330_3.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">To recover the occupancy probability from the Odds representation given in <a class="internaljump" href="#ch09eqn341C14020F-F9F5-4415-973A-D906072C1A72">(9.34)</a>, we use the following law which can easily be derived from <a class="internaljump" href="#ch09eqn331C14020F-F9F5-4415-973A-D906072C1A72">(9.33)</a>.</p>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.37)&nbsp;</span></td><td valign="top"><img src="figu330_4.jpg" />
<br />
</td>
</tr>
</table>
</div>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.38)&nbsp;</span></td><td valign="top"><img src="figu330_5.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">This leads to</p>
<div class="equation" mathml="yes">
<a name="831"></a><a name="ch09eqn391C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.39)&nbsp;</span></td><td valign="top"><img src="figu330_6.jpg" />
<br />
</td>
</tr>
</table>
</div>
<div class="widecontent">
<div class="example">
<span class="example-title"><span class="example-titlelabel">Algorithm 19: </span>Occupancy grid mapping with known locations</span><a name="832"></a><a name="ch09al191C14020F-F9F5-4415-973A-D906072C1A72"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img alt="Image from book" src="_.gif" width="1" height="2" title="Start example" border="0" /></b></font></td>
</tr>
</table>
<pre class="programlisting">
<a name="833"></a><a name="IDX-3311C14020F-F9F5-4415-973A-D906072C1A72"></a>
<b class="bold">Input:</b> Sequence of measurements <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>) and corresponding positions <i class="emphasis">x</i>(1 : <i class="emphasis">k</i>)
and an initial belief <i class="emphasis">P</i><sub>0</sub>(<i class="emphasis">m</i>) that the cells in the map are occupied
<b class="bold">Output:</b> Posterior <i class="emphasis">P<sub>m</sub></i> = <i class="emphasis">P</i>(<i class="emphasis">m</i> | <i class="emphasis">x</i>(1 : <i class="emphasis">k</i>), <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>)) that the cells in the map are
occupied
1: <i class="emphasis">P<sub>m</sub></i> ? <i class="emphasis">P</i><sub>0</sub>(<i class="emphasis">m</i>)
2: <b class="bold">for</b> <i class="emphasis">i</i> ? 1 to <i class="emphasis">k</i> <b class="bold">do</b>
3: <span class="inlinemediaobject"><img alt="Image from book" id="IMG_1348" src="figu331_1.jpg" height="42" width="345" title="" border="0" /></span>
4: <b class="bold">end for</b>
</pre>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img alt="Image from book" src="_.gif" width="1" height="2" title="End example" border="0" /></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
</div>
<p class="para">
<a class="internaljump" href="#ch09al191C14020F-F9F5-4415-973A-D906072C1A72">Algorithm 19</a> uses the recursive nature of <a class="internaljump" href="#ch09eqn391C14020F-F9F5-4415-973A-D906072C1A72">(9.39)</a> to compute the posterior <i class="emphasis">P</i>(<i class="emphasis">m</i> | <i class="emphasis">x</i>(1 : <i class="emphasis">k</i>), <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>)). It receives as input the sequence of measurements <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>) and the corresponding locations of the robot <i class="emphasis">x</i>(1 : <i class="emphasis">k</i>), as well as the initial probability <i class="emphasis">P</i><sub>0</sub>(<i class="emphasis">m</i>) about the occupancy probability of the cells in the map. Typically, <i class="emphasis">P</i><sub>0</sub>(<i class="emphasis">m</i>) will be initialized with the prior probability <i class="emphasis">P</i>(<i class="emphasis">m</i>). If one wants to apply <a class="internaljump" href="#ch09al191C14020F-F9F5-4415-973A-D906072C1A72">Algorithm 19</a> to multiple sequences of measurements, <i class="emphasis">P</i><sub>0</sub>(<i class="emphasis">m</i>) can also be initialized with the output obtained from the previous application of the algorithm.</p>
<p class="para">It remains to describe how we actually compute <i class="emphasis">P</i>(<i class="emphasis">m</i> | <i class="emphasis">x</i>(<i class="emphasis">k</i>), <i class="emphasis">y</i>(<i class="emphasis">k</i>)). Several techniques for determining this quantity have been presented. Whereas Moravec and Elfes [144, 325] used a probabilistic model to compute this quantity for ultrasound measurements, Thrun [411] applied a neural network to learn the appropriate interpretation of the measurements obtained with sonar sensors. The map depicted in the right image of <a href="30.html#278" target="_parent" class="chapterjump">figure 5.1</a> in <a href="30.html" target="_parent" class="chapterjump">chapter 5</a> has been computed with Thrun's approach. In this chapter we present a model that can be regarded as an approximate version of the approach described by Elfes [144].</p>
<p class="para">One key assumption of occupancy probability grid-mapping techniques is that the individual cells of the map <i class="emphasis">m</i> can be considered independently. Accordingly, the posterior probability of <i class="emphasis">m</i> is computed as</p>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.40)&nbsp;</span></td><td valign="top"><img src="figu331_2.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">The advantage of this approach is that it suffices to describe how to update a single cell upon sensory input. Given this assumption, all we need to specify is the quantity <i class="emphasis">P</i>(<i class="emphasis">m<sub>l</sub></i> | <i class="emphasis">x</i>(<i class="emphasis">k</i>), <i class="emphasis">y</i>(<i class="emphasis">k</i>)) which is the probability that cell <i class="emphasis">m<sub>l</sub></i> is occupied given the measurement <i class="emphasis">y</i>(<i class="emphasis">k</i>) and the state <i class="emphasis">x</i>(<i class="emphasis">k</i>) of the robot.</p>
<p class="para">The model <i class="emphasis">P</i>(<i class="emphasis">m<sub>l</sub></i> | <i class="emphasis">x</i>(<i class="emphasis">k</i>), <i class="emphasis">y</i>(<i class="emphasis">k</i>)) described here considers for each cell <i class="emphasis">m<sub>l</sub></i> the difference between the measured distance <i class="emphasis">y</i>(<i class="emphasis">k</i>) and distance of <i class="emphasis">m<sub>l</sub></i> from <i class="emphasis">x</i>(<i class="emphasis">k</i>). In the case of <a name="834"></a><a name="IDX-3321C14020F-F9F5-4415-973A-D906072C1A72"></a>ultrasound sensors the signal is typically emitted in a cone. To compute the occupancy probability of a cell <i class="emphasis">m<sub>l</sub></i> we therefore also consider the angle ? between the optical axis of the sensor and the ray going through <i class="emphasis">m<sub>l</sub></i> and <i class="emphasis">x</i>(<i class="emphasis">k</i>) (see <a class="internaljump" href="#ch09fig121C14020F-F9F5-4415-973A-D906072C1A72">figure 9.12</a>). The occupancy probability <i class="emphasis">P</i>(<i class="emphasis">m<sub>l</sub></i> | <i class="emphasis">x</i>(<i class="emphasis">k</i>), <i class="emphasis">y</i>(<i class="emphasis">k</i>)) = <i class="emphasis">P</i>(<i class="emphasis">m</i><sub><i class="emphasis">d</i>, ?</sub>(<i class="emphasis">x</i>(<i class="emphasis">k</i>)) | <i class="emphasis">y</i>(<i class="emphasis">k</i>), <i class="emphasis">x</i>(<i class="emphasis">k</i>)) of <i class="emphasis">m<sub>l</sub></i> is then computed using the following function, which can be regarded as an approximation of the mixture of Gaussians and linear functions applied by Elfes [144].</p>
<div class="equation" mathml="yes">
<a name="835"></a><a name="ch09eqn411C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.41)&nbsp;</span></td><td valign="top"><img src="figu332_1.jpg" />
<br />
</td>
</tr>
</table>
</div>
<div class="figure">
<a name="836"></a><a name="ch09fig121C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1351','fig9-12_0.jpg','1000','421')" name="IMG_1351" target="_self"><img alt="Image from book" id="IMG_1351" src="fig9-12.jpg" height="147" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.12: </span>The occupancy probability of a cell <i class="emphasis">m<sub>l</sub></i> = <i class="emphasis">m</i><sub><i class="emphasis">d</i>, ?</sub>(<i class="emphasis">x</i>(<i class="emphasis">k</i>)) depends on the distance <i class="emphasis">d</i> to <i class="emphasis">x</i>(<i class="emphasis">k</i>) and the angle ? to the optical axis of the cone.</span>
</div>
<p class="para">In this definition <i class="emphasis">s</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>), ?) is a function that computes the deviation of the occupancy probability from the prior occupancy probability <i class="emphasis">P</i>(<i class="emphasis">m</i>) given the measured distance <i class="emphasis">y</i>(<i class="emphasis">k</i>) and the angle ? between the cell, the sensor, and its optical axis. A common choice for <i class="emphasis">s</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>), ?) is a product of a linear function <i class="emphasis">g</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>)) and a Gaussian <span xmlns:mml="http://www.w3.org/1998/Math/MathML" class="inlinequation"><span class="inlinemediaobject"><img alt="Image from book" id="IMG_1352" src="figu332_2.jpg" height="20" width="75" title="" border="0" /></span></span>:</p>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.42)&nbsp;</span></td><td valign="top"><img src="figu332_3.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">
<a class="internaljump" href="#ch09fig131C14020F-F9F5-4415-973A-D906072C1A72">figure 9.13</a> plots these two components as they are used in the examples shown in this section. The variance ?<sub>?</sub> of the Gaussian is 0.05. <a class="internaljump" href="#ch09fig141C14020F-F9F5-4415-973A-D906072C1A72">Figure 9.14</a> plots <i class="emphasis">s</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>), ?) for <i class="emphasis">y</i>(<i class="emphasis">k</i>) ? [0; 3<i class="emphasis">m</i>] and <span xmlns:mml="http://www.w3.org/1998/Math/MathML" class="inlinequation"><span class="inlinemediaobject"><img alt="Image from book" id="IMG_1354" src="figu332_4.jpg" height="22" width="112" title="" border="0" /></span></span>. This angular range is identical to the opening angle of 15 degrees of the ultrasound sensors used to acquire the data of the examples presented here.</p>
<div class="figure">
<a name="837"></a><a name="ch09fig131C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1355','fig9-13_0.jpg','1000','388')" name="IMG_1355" target="_self"><img alt="Image from book" id="IMG_1355" src="fig9-13.jpg" height="136" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.13: </span>Functions used to compute the function <i class="emphasis">s</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>), ?): linear function (left) and Gaussian (right).</span>
</div>
<div class="figure">
<a name="838"></a><a name="ch09fig141C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1356','fig9-14_0.jpg','713','509')" name="IMG_1356" target="_self"><img alt="Image from book" id="IMG_1356" src="fig9-14.jpg" height="250" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.14: </span>Function <i class="emphasis">s</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>), ?) used to model the deviation from the prior for cells in the sensor cone.</span>
</div>
<p class="para">
<a name="839"></a><a name="IDX-3331C14020F-F9F5-4415-973A-D906072C1A72"></a>The constants <i class="emphasis">d</i><sub>1</sub>, <i class="emphasis">d</i><sub>2</sub>, and <i class="emphasis">d</i><sub>3</sub> in <a class="internaljump" href="#ch09eqn411C14020F-F9F5-4415-973A-D906072C1A72">(9.41)</a> specify the interval in which the different linear functions of the piecewise linear approximation are valid (see also <a class="internaljump" href="#ch09fig151C14020F-F9F5-4415-973A-D906072C1A72">figure 9.15</a>). The occupancy probability of cells lying between <i class="emphasis">x</i>(<i class="emphasis">k</i>) and the arc from which the signal was reflected must be smaller than the prior probability for occupancy. In our model the occupancy probability of cells with <i class="emphasis">d</i> &lt; <i class="emphasis">y</i>(<i class="emphasis">k</i>) ?<i class="emphasis">d</i><sub>1</sub> therefore is computed as <i class="emphasis">P</i>(<i class="emphasis">m<sub>l</sub></i>)?<i class="emphasis">s</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>), ?). The occupancy probability of cells whose distance to <i class="emphasis">x</i>(<i class="emphasis">k</i>) is close to <i class="emphasis">y</i>(<i class="emphasis">k</i>), i.e., for which <i class="emphasis">y</i>(<i class="emphasis">k</i>) ? <i class="emphasis">d</i><sub>1</sub> ? <i class="emphasis">d</i> &lt; <i class="emphasis">y</i>(<i class="emphasis">k</i>) + <i class="emphasis">d</i><sub>1</sub>, is computed by a linear function that increases with <i class="emphasis">d</i>.Ifa beam ends in a cell it is commonly assumed that the world is also occupied at least for a certain range behind that cell. In our model the occupancy probability therefore stays at a high but constant level <i class="emphasis">P</i>(<i class="emphasis">m<sub>l</sub></i>) + <i class="emphasis">s</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>), ?) for all cells whose distance lies between <i class="emphasis">y</i>(<i class="emphasis">k</i>) + <i class="emphasis">d</i><sub>1</sub> and <i class="emphasis">y</i>(<i class="emphasis">k</i>) + <i class="emphasis">d</i><sub>2</sub>. Accordingly, the constants <a name="840"></a><a name="IDX-3341C14020F-F9F5-4415-973A-D906072C1A72"></a><i class="emphasis">d</i><sub>1</sub> and <i class="emphasis">d</i><sub>2</sub> encode the average depth of obstacles. For distances <i class="emphasis">d</i> with <i class="emphasis">y</i>(<i class="emphasis">k</i>) + <i class="emphasis">d</i><sub>2</sub> ? <i class="emphasis">d</i> &lt; <i class="emphasis">y</i>(<i class="emphasis">k</i>) + <i class="emphasis">d</i><sub>3</sub>, we assume that the occupancy probability linearly decreases to the prior occupancy probability <i class="emphasis">P</i>(<i class="emphasis">m<sub>l</sub></i>). Finally, for cells <i class="emphasis">m<sub>l</sub></i> = <i class="emphasis">m</i><sub><i class="emphasis">d</i>, ?</sub>(<i class="emphasis">x</i>(<i class="emphasis">k</i>)) whose distance from <i class="emphasis">x</i>(<i class="emphasis">k</i>) exceeds <i class="emphasis">y</i>(<i class="emphasis">k</i>) + <i class="emphasis">d</i><sub>3</sub> we can safely assume that <i class="emphasis">P</i>(<i class="emphasis">m</i><sub><i class="emphasis">d</i>, ?</sub>(<i class="emphasis">x</i>(<i class="emphasis">k</i>)) | <i class="emphasis">y</i>(<i class="emphasis">k</i>), <i class="emphasis">x</i>(<i class="emphasis">k</i>)) equals the prior probability <i class="emphasis">P</i>(<i class="emphasis">m<sub>l</sub></i>), since <i class="emphasis">y</i>(<i class="emphasis">k</i>) does not give us any information about such cells. <a class="internaljump" href="#ch09fig151C14020F-F9F5-4415-973A-D906072C1A72">Figure 9.15</a> plots <i class="emphasis">P</i>(<i class="emphasis">m</i><sub><i class="emphasis">d</i>, ?</sub>(<i class="emphasis">x</i>(<i class="emphasis">k</i>)) | <i class="emphasis">y</i>(<i class="emphasis">k</i>), <i class="emphasis">x</i>(<i class="emphasis">k</i>)) for <i class="emphasis">d</i> ranging from 0 <i class="emphasis">m</i> to 3 <i class="emphasis">m</i> given that <i class="emphasis">y</i>(<i class="emphasis">k</i>) is 2 <i class="emphasis">m</i> and that ? is 0 degrees. In this case, the value of <i class="emphasis">s</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>), ?) is approximately 0.16. We additionally assume that the prior probability <i class="emphasis">P</i>(<i class="emphasis">m<sub>l</sub></i>) = <i class="emphasis">P</i>(<i class="emphasis">m</i><sub><i class="emphasis">d</i>, ?</sub>(<i class="emphasis">x</i>(<i class="emphasis">k</i>))) = 0.5 for all <i class="emphasis">d</i>, ?, and <i class="emphasis">x</i>(<i class="emphasis">k</i>).</p>
<div class="figure">
<a name="841"></a><a name="ch09fig151C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1357','fig9-15_0.jpg','1000','616')" name="IMG_1357" target="_self"><img alt="Image from book" id="IMG_1357" src="fig9-15.jpg" height="216" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.15: </span>Probability <i class="emphasis">P</i>(<i class="emphasis">m</i><sub><i class="emphasis">d</i>, ?</sub>(<i class="emphasis">x</i>(<i class="emphasis">k</i>)) that a cell on the optical axis of the sensor (? = 0) is occupied depending on the distance of that cell from the sensor. The measured distance is 2<i class="emphasis">m</i>.</span>
</div>
<p class="para">
<a class="internaljump" href="#ch09fig161C14020F-F9F5-4415-973A-D906072C1A72">Figure 9.16</a> shows three-dimensional plots of the resulting occupancy probabilities for measurements of 2.0 <i class="emphasis">m</i> and 2.5 <i class="emphasis">m</i>. In both plots the optical axis of the sensor cone is identical to the <i class="emphasis">x</i>-axis and the sensor is located in the origin of the coordinate frame. As can be seen from the figure, the occupancy probability is high for cells whose distance to <i class="emphasis">x</i>(<i class="emphasis">k</i>) is close to <i class="emphasis">y</i>(<i class="emphasis">k</i>). It decreases for cells with distance <i class="emphasis">y</i>(<i class="emphasis">k</i>) from <i class="emphasis">x</i>(<i class="emphasis">k</i>) and with increasing values of ?. Furthermore, it stays constant for cells that are immediately behind a cell that might have reflected the beam and linearly decreases to the prior probability afterward. For cells that are covered by the beam but did not reflect it, the occupancy probability is decreased.</p>
<div class="figure">
<a name="842"></a><a name="ch09fig161C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1358','fig9-16_0.jpg','1000','332')" name="IMG_1358" target="_self"><img alt="Image from book" id="IMG_1358" src="fig9-16.jpg" height="116" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.16: </span>Local occupancy probability grids for a single ultrasound measurement of <i class="emphasis">y</i>(<i class="emphasis">k</i>) = 2.0<i class="emphasis">m</i> (left) and <i class="emphasis">y</i>(<i class="emphasis">k</i>) = 2.5<i class="emphasis">m</i> (right).</span>
</div>
<p class="para">
<a name="843"></a><a name="IDX-3351C14020F-F9F5-4415-973A-D906072C1A72"></a><a class="internaljump" href="#ch09fig171C14020F-F9F5-4415-973A-D906072C1A72">Figure 9.17</a> shows our sensor model in action for a sequence of measurements recorded with a B21r robot in a corridor environment. The upper-left corner shows a map that has been built from a sequence of ultrasound scans. Afterward the robot perceived a series of eighteen ultrasound scans each consisting of 24 measurements. <a name="844"></a><a name="IDX-3361C14020F-F9F5-4415-973A-D906072C1A72"></a>The occupancy probabilities for these eighteen scans are depicted in the three columns in the center of this figure. Note that during mapping we did not use measurements whose distance exceeded 2.5<i class="emphasis">m</i>. The occupancy probability grid obtained by integrating the individual observations into the initial map is shown in the lower-right corner of this figure. As can be seen, the belief converges to an accurate representation of the corridor structure although the individual measurements show a high amount of uncertainty, as is usually the case for ultrasound sensors.</p>
<div class="figure">
<a name="845"></a><a name="ch09fig171C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1359','fig9-17_0.jpg','1000','510')" name="IMG_1359" target="_self"><img alt="Image from book" id="IMG_1359" src="fig9-17.jpg" height="179" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.17: </span>Incremental mapping in a corridor environment. The upper left image shows the initial map and the lower right image contains the resulting map. The maps in the three middle columns are the local maps built from the individual ultrasound scans perceived by the robot. Throughout this process, measurements beyond a 2.5 <i class="emphasis">m</i> radius have not been considered.</span>
</div>
<p class="para">The left image of <a class="internaljump" href="#ch09fig181C14020F-F9F5-4415-973A-D906072C1A72">figure 9.18</a> shows the occupancy probabilities of the corridor environment obtained after incorporating all measurements of the data set used here. The map represents a 17 <i class="emphasis">m</i> long and 11 <i class="emphasis">m</i> wide part of a corridor environment including three rooms. The right image shows the corresponding maximum-likelihood map. This map is obtained from the occupancy probability grid by a simple clipping operation with a threshold of 0.5. The gray areas of the maximum-likelihood map correspond to cells that have not been sensed by the robot.</p>
<div class="figure">
<a name="846"></a><a name="ch09fig181C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1360','fig9-18_0.jpg','1000','364')" name="IMG_1360" target="_self"><img alt="Image from book" id="IMG_1360" src="fig9-18.jpg" height="127" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.18: </span>Occupancy probability map for the corridor of the Autonomous Intelligent Systems Lab at the University of Freiburg (left) and the corresponding maximum-likelihood map (right).</span>
</div>
<p class="para">Let us briefly discuss some aspects that might be relevant to potential improvements of the models described here. The strongest restriction results from the assumption that all cells of the grid are considered independently. This independence assumption decomposes the high-dimensional state estimation problem into a set of onedimensional estimation problems. The independency of individual cells, however, is usually not justified in practice. For example, if the robot detects a door, then particular cells in the neighborhood need to be upd ted according to the specific shape of the door. Accordingly, techniques considering the individual cells of a grid independently might produce suboptimal solutions. One technique that addresses this problem has recently been presented by Thrun [413].</p>
<p class="last-para">
<a name="847"></a><a name="IDX-3371C14020F-F9F5-4415-973A-D906072C1A72"></a>Additionally, occupancy probability grid maps assume that the environment has a binary structure, i.e., that every cell is either occupied or free. Occupancy probabilities cannot correctly represent situations in which a cell is only partly covered by an obstacle. Finally, most of the techniques, as well as our model, assume that the individual beams of the sensors can be considered independently when updating a map. This assumption also is not justified in practice, since neighboring beams of a scan often yield similar values. Accordingly, a robot ignoring this might become overly confident of the state of the environment.</p>
</div>
<div class="section">
<h3 class="sect3-title">
<a name="848"></a><a name="ch09lev2sec71C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="section-titlelabel">9.2.2 </span>Bayesian Simultaneous Localization and Mapping</h3>
<p class="first-para">In the previous subsection, we assumed that the robot always knows its position while it is mapping the environment. This assumption, however, is typically not justified, especially when a robot has to rely on its onboard sensors to determine its position due to the lack of a global positioning system, active beacons, or predefined landmarks. In such a situation, mapping turns into the so-called chicken and egg problem. Without a map the robot cannot determine its own position and without knowledge about its own position the robot cannot compute what its environment looks like. This is why this problem is often denoted as the SLAM problem (see also <a href="48.html" target="_parent" class="chapterjump">chapter 8</a>).</p>
<p class="para">In the past, research in the area of SLAM has led to two different types of approaches, each of which has its advantages and disadvantages [412]. The first class contains algorithms relying on the EKF to estimate joint posteriors over maps and robot locations [100,128,277]. These approaches provide a sound mathematical framework (see also <a href="48.html" target="_parent" class="chapterjump">chapter 8</a>). However, they mainly have been applied in situations in which the environment contains predefined landmarks.</p>
<p class="para">The second class of techniques considers the SLAM problem as a global optimization problem. For example, Lu and Milios [299] consider robot locations as random variables and derive constraints between locations from distances between overlapping range measurements and from odometry measurements. The constraints can be regarded as links in a network of springs, whose energy is to be minimized. Other approaches apply Dempster, Laird and Rubin's <i class="emphasis">expectation maximization</i>, or <i class="emphasis">EM</i> algorithm[127] to compute the maximum-likelihood estimate for the map and the locations of the robot. Examples of these kind of techniques can be found in [84,126,382,417]. EM-based techniques have been applied successfully to mapping large cyclic environments with highly ambiguous features. However, they are inherently batch algorithms, requiring multiple passes through the entire data set. As a consequence, they usually cannot be applied when a robot has to map its environment online, i.e., while it is exploring it.</p>
<p class="para">In probabilistic terms the problem of SLAM is to find the map and the robot positions which yield the best interpretation of the data gathered by the robot. As in <a name="849"></a><a name="IDX-3381C14020F-F9F5-4415-973A-D906072C1A72"></a><a href="54.html#755" target="_parent" class="chapterjump">Section 9.1</a> the data consist of a stream of odometry measurements <i class="emphasis">u</i>(0 : <i class="emphasis">k</i> ? 1) and perceptions of the environment <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>). According to Thrun [412], the mapping problem can be phrased as recursive Bayesian filtering for estimating the robot positions along with a map of the environment:</p>
<div class="equation" mathml="yes">
<a name="850"></a><a name="ch09eqn431C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.43)&nbsp;</span></td><td valign="top"><img src="figu338_1.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">As in probabilistic localization (see <a href="54.html#755" target="_parent" class="chapterjump">Section 9.1</a>) we assume that the odometry measurements are governed by a so-called probabilistic motion model <i class="emphasis">P</i>(<i class="emphasis">x</i>(<i class="emphasis">k</i>) | <i class="emphasis">x</i>(<i class="emphasis">k</i> ? 1), <i class="emphasis">u</i>(<i class="emphasis">k</i> ? 1)) which specifies the likelihood that the robot is at <i class="emphasis">x</i>(<i class="emphasis">k</i>) given that it previously was at <i class="emphasis">x</i>(<i class="emphasis">k</i> ? 1) and the motion <i class="emphasis">u</i>(<i class="emphasis">k</i> ? 1) was measured. On the other hand, the observations follow the sensor model <i class="emphasis">P</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>) | <i class="emphasis">x</i>(<i class="emphasis">k</i>), <i class="emphasis">m</i>), which defines for every possible location <i class="emphasis">x</i>(<i class="emphasis">k</i>) in the environment the likelihood of the observation <i class="emphasis">y</i>(<i class="emphasis">k</i>) given the map <i class="emphasis">m</i>.</p>
<p class="para">Unfortunately, estimating the full posterior in <a class="internaljump" href="#ch09eqn431C14020F-F9F5-4415-973A-D906072C1A72">(9.43)</a> is not tractable in general. One approach is to apply incremental scan matching [180, 182, 365, 424]. The general idea of such approaches can be summarized as follows. At any point <i class="emphasis">k</i> ? 1 in time, the robot is given an estimate of its location <span xmlns:mml="http://www.w3.org/1998/Math/MathML" class="inlinequation"><span class="inlinemediaobject"><img alt="Image from book" id="IMG_1362" src="figu338_2.jpg" height="18" width="70" title="" border="0" /></span></span> and a map <span xmlns:mml="http://www.w3.org/1998/Math/MathML" class="inlinequation"><span class="inlinemediaobject"><img alt="Image from book" id="IMG_1363" src="figu338_3.jpg" height="19" width="239" title="" border="0" /></span></span>. After moving and taking a new measurement <i class="emphasis">y</i>(<i class="emphasis">k</i>), the robot determines the most likely new location <span xmlns:mml="http://www.w3.org/1998/Math/MathML" class="inlinequation"><span class="inlinemediaobject"><img alt="Image from book" id="IMG_1364" src="figu338_4.jpg" height="18" width="36" title="" border="0" /></span></span> such that</p>
<div class="equation" mathml="yes">
<a name="851"></a><a name="ch09eqn441C14020F-F9F5-4415-973A-D906072C1A72"></a>
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.44)&nbsp;</span></td><td valign="top"><img src="figu338_5.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">It does this by trading off the consistency of the measurement with the map [first term on the right-hand side in <a class="internaljump" href="#ch09eqn441C14020F-F9F5-4415-973A-D906072C1A72">(9.44)</a>] and the consistency of the new location with the control action and the previous location [second term on the right-hand side in <a class="internaljump" href="#ch09eqn441C14020F-F9F5-4415-973A-D906072C1A72">(9.44)</a>]. The map is then extended by the new measurement <i class="emphasis">y</i>(<i class="emphasis">k</i>), using the location <span xmlns:mml="http://www.w3.org/1998/Math/MathML" class="inlinequation"><span class="inlinemediaobject"><img alt="Image from book" id="IMG_1366" src="figu338_6.jpg" height="18" width="36" title="" border="0" /></span></span> as the location at which this measurement was taken. Popular techniques to determine <span xmlns:mml="http://www.w3.org/1998/Math/MathML" class="inlinequation"><span class="inlinemediaobject"><img alt="Image from book" id="IMG_1367" src="figu338_7.jpg" height="18" width="36" title="" border="0" /></span></span> in the context of laser range scans are the iterative-closest-point algorithm [46] or variants thereof.</p>
<p class="para">The key limitation of scan-matching approaches lies in the greedy maximization step. Once the location <i class="emphasis">x</i>(<i class="emphasis">k</i>) at time <i class="emphasis">k</i> has been computed it is not revised afterward so that the robot cannot recover from registration errors. Although scan matching techniques have been proven to be able to correct enormous errors in odometry, the resulting maps often are globally inconsistent. As an example consider <a class="internaljump" href="#ch09fig191C14020F-F9F5-4415-973A-D906072C1A72">figure 9.19</a> <a name="852"></a><a name="IDX-3391C14020F-F9F5-4415-973A-D906072C1A72"></a>which shows a map generated from raw odometry and laser range data obtained with a B21r robot. As can be seen from the figure, the robot suffers from serious errors in odometry so that the resulting map is useless without any correction. The size of this environment is 28 m <span class="unicode">&#1504;</span>28 m. When recording the data the robot traveled 491 m with an average speed of 0.19 m/s. <a class="internaljump" href="#ch09fig201C14020F-F9F5-4415-973A-D906072C1A72">Figure 9.20</a> shows the map created with the scan matching system presented by H<span class="extended-unicode">&#18990;</span>el, Schulz, and Burgard [182]. Although the local structures of the map appear to be very accurate, the map is globally inconsistent. For example, many structures like walls, doors, and such can be found several times and with a small offset between them.</p>
<div class="figure">
<a name="853"></a><a name="ch09fig191C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1368','fig9-19_0.jpg','925','805')" name="IMG_1368" target="_self"><img alt="Image from book" id="IMG_1368" src="fig9-19.jpg" height="305" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.19: </span>Map generated from raw odometry and laser range data gathered with a B21r robot.</span>
</div>
<div class="figure">
<a name="854"></a><a name="ch09fig201C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1369','fig9-20_0.jpg','926','931')" name="IMG_1369" target="_self"><img alt="Image from book" id="IMG_1369" src="fig9-20.jpg" height="352" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.20: </span>Map obtained by applying a scan-matching approach to the same data used in <a class="internaljump" href="#ch09fig191C14020F-F9F5-4415-973A-D906072C1A72">figure 9.19</a>.</span>
</div>
<p class="para">To overcome this problem, alternative approaches have been developed. The key idea of these techniques is to maintain a posterior about the position of the vehicle. Whereas Gutmann and Konolige [178] used a discrete and grid-based approximation of the belief about the robots location, Thrun [412] applied a particle filter for this purpose. However, both approaches only maintain a single map and revise previous decisions whenever the robot closes a loop and returns to a previously visited place.</p>
<p class="para">More recently, Murphy and coworkers [137,329] have proposed <i class="emphasis">Rao-Blackwellized particle filtering</i> as an efficient means to maintain multiple hypotheses during mapping. The key idea of this approach can be understood more easily when one considers the graphical model depicted in <a class="internaljump" href="#ch09fig211C14020F-F9F5-4415-973A-D906072C1A72">figure 9.21</a>. If we know the map, the overall problem is transformed into a localization problem where the task is to estimate the location <a name="855"></a><a name="IDX-3411C14020F-F9F5-4415-973A-D906072C1A72"></a>of the robot at each point in time. If, however, the locations are known, it remains solely to compute the map. Note that the knowledge of <i class="emphasis">x</i>(1 : <i class="emphasis">k</i>) is sufficient to figure out what the environment looks like, whereas <i class="emphasis">x</i>(0) only determines the location of the map. Thus, if <i class="emphasis">x</i>(1 : <i class="emphasis">k</i>) is known but <i class="emphasis">x</i>(0) is unknown, the robot can estimate its position relative to the map, but it cannot determine the location of the map.</p>
<div class="figure">
<a name="856"></a><a name="ch09fig211C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1370','fig9-21_0.jpg','908','586')" name="IMG_1370" target="_self"><img alt="Image from book" id="IMG_1370" src="fig9-21.jpg" height="226" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.21: </span>Graphical model of incremental probabilistic SLAM.</span>
</div>
<p class="para">The application of Rao-Blackwellized particle filtering to mapping is motivated by the observation that once the path <i class="emphasis">x</i>(1 : <i class="emphasis">k</i>) of the robot is known, the maximum-likelihood map can be computed analytically, e.g., using the method described in <a class="internaljump" href="#ch09lev2sec61C14020F-F9F5-4415-973A-D906072C1A72">subsection 9.2.1</a>. Therefore, the goal of SLAM with Rao-Blackwellized particle filters is to estimate the path of the robot using a particle filter and to analytically compute the map corresponding to that path. In practice this means that we use a set of particles to represent a posterior about potential paths of the robot. To each of these paths we associate an individual map that is computed based on the hypothesis that this path corresponds to the true path of the robot. The importance weight of a sample is proportional to the likelihood of the most recent observation given the map, which is computed based on the previous observations and the path of the robot according to that particular particle.</p>
<p class="para">Note that Rao-Blackwellized particle filtering [136,137] is a general technique to reduce the size of high-dimensional state estimation problems by marginalizing out parts of the state space. In this section we use this technique to develop an efficient solution to the SLAM problem.</p>
<p class="para">Let us again consider the posterior <i class="emphasis">P</i>(<i class="emphasis">x</i>(1 : <i class="emphasis">k</i>), <i class="emphasis">m</i> | <i class="emphasis">u</i>(0 : <i class="emphasis">k</i> ? 1), <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>)) we want to estimate. If we apply the chain rule of probability theory, we obtain</p>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.45)&nbsp;</span></td><td valign="top"><img src="figu341_1.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">Obviously, we can safely assume that <i class="emphasis">m</i> is independent of <i class="emphasis">u</i>(0 : <i class="emphasis">k</i> ? 1) once we know the locations <i class="emphasis">x</i>(1 : <i class="emphasis">k</i>) of the robot, i.e.,</p>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.46)&nbsp;</span></td><td valign="top"><img src="figu341_2.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">This leads to</p>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.47)&nbsp;</span></td><td valign="top"><img src="figu341_3.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">In the <a class="internaljump" href="#ch09lev2sec61C14020F-F9F5-4415-973A-D906072C1A72">previous section</a> we saw that we can efficiently compute the posterior <i class="emphasis">P</i>(<i class="emphasis">m</i> | <i class="emphasis">x</i>(1 : <i class="emphasis">k</i>), <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>)) for <i class="emphasis">m</i> given we know <i class="emphasis">x</i>(1 : <i class="emphasis">k</i>) and <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>). Thus, all we need to do is to sample <i class="emphasis">P</i>(<i class="emphasis">x</i>(1 : <i class="emphasis">k</i>) | <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>), <i class="emphasis">u</i>(0 : <i class="emphasis">k</i> ? 1)) using a particle filter and compute for each particle the map that is associated to it.</p>
<p class="para">
<a name="857"></a><a name="IDX-3421C14020F-F9F5-4415-973A-D906072C1A72"></a>We proceed as follows. Suppose <span xmlns:mml="http://www.w3.org/1998/Math/MathML" class="inlinequation"><span class="inlinemediaobject"><img alt="Image from book" id="IMG_1374" src="figu342_1.jpg" height="16" width="23" title="" border="0" /></span></span> is a set of particles that represents the posterior about potential paths of the robot. In the beginning we assume that each particle starts at [0, 0, 0]<sup><i class="emphasis">T</i></sup>, i.e., the robot is located at the origin of the coordinate system and its heading is 0. Let us furthermore denote the path associated with the <i class="emphasis">j</i>th particle by <i class="emphasis">h</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">k</i>). As described above, once the path of the robot is known, we can directly compute the most likely map for that particle:</p>
<div class="equation" mathml="yes">
<table border="0" cellspacing="0" cellpadding="0">
<tr>
<td valign="top"><span class="equation-label">(9.48)&nbsp;</span></td><td valign="top"><img src="figu342_2.jpg" />
<br />
</td>
</tr>
</table>
</div>
<p class="para">Whenever an odometry measurement <i class="emphasis">u</i>(<i class="emphasis">i</i> ? 1) is obtained, we proceed in the same way as we do in probabilistic localization. For each sample we compute the next location <i class="emphasis">x</i> = <i class="emphasis">x</i>?<sup><i class="emphasis">j</i></sup> of its path by sampling from <i class="emphasis">P</i>(<i class="emphasis">x</i> | <i class="emphasis">x<sub>j</sub></i>, <i class="emphasis">u</i>(<i class="emphasis">i</i> ? 1)). Note that-as in probabilistic localization-we in principle had to sample from <i class="emphasis">P</i>(<i class="emphasis">x</i> | <i class="emphasis">x<sub>j</sub></i>, <i class="emphasis">u</i>(<i class="emphasis">i</i> ? 1), <i class="emphasis">m</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">k</i> ? 1)), i.e., we also had to consider the map <i class="emphasis">m</i><sup>(<i class="emphasis">j</i>)</sup> (1 : <i class="emphasis">k</i> ? 1) associated with each sample. In practice, however, the map is often ignored for reasons of efficiency since computing <i class="emphasis">P</i>(<i class="emphasis">x</i> | <i class="emphasis">x<sub>j</sub></i>, <i class="emphasis">u</i>(<i class="emphasis">i</i> ? 1), <i class="emphasis">m</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">k</i> ? 1)) typically involves a time-consuming ray-casting operation in <i class="emphasis">m</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">k</i> ? 1). Once we have computed for the <i class="emphasis">j</i>th particle both the map <i class="emphasis">m</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">k</i> ? 1) and the new location <i class="emphasis">x</i>?<sub><i class="emphasis">j</i></sub>, we are ready to compute the likelihood of the observation <i class="emphasis">y</i>(<i class="emphasis">k</i>) and to use the resulting quantity as an importance weight during the resampling step. As a sensor model we can, e.g., choose the model described in <a href="54.html#755" target="_parent" class="chapterjump">section 9.1</a>. The overall approach is realized by <a class="internaljump" href="#ch09al201C14020F-F9F5-4415-973A-D906072C1A72">algorithm 20</a>. Note that, according to the recursive structure of the problem, this algorithm can easily be extended for multiple sequences of sensory input. To do so, one simply has to ensure that the initialization is carried out using the output obtained from the previous application of the algorithm.</p>
<p class="para">Please note that two aspects of this algorithm need to be implemented carefully to obtain the desired efficiency and convergence. If the map <i class="emphasis">m</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">k</i> ? 1) is computed from scratch in every round, the resulting algorithm will be quadratic in <i class="emphasis">k</i>. On the other hand, maintaining a complete map for each individual particle (which also needs to be updated in each round) is inefficient with respect to memory. Additionally, it involves a time-consuming operation if the map associated with a sample has to be copied once for each of its successors in the resampling step. A popular approach to overcome this problem is to use treelike structures such as those proposed by Montemerlo et al [321], as well as by Parr and Eliazar [346]. Since typically many of the particles have larger parts of their history in common, the maps associated with the particles can efficiently be represented using trees.</p>
<p class="para">An alternative although approximative approach to compute the maps associated with the individual samples is based on the observation that, in order to compute <i class="emphasis">P</i>(<i class="emphasis">y</i>(<i class="emphasis">k</i>) | <i class="emphasis">x<sub>j</sub></i>, <i class="emphasis">m</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">k</i> ? 1)), we only need to determine the part of the map <i class="emphasis">m</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">k</i> ? 1) that is covered by <i class="emphasis">y</i>(<i class="emphasis">k</i>). If we furthermore use only a limited number of <a name="858"></a><a name="IDX-3431C14020F-F9F5-4415-973A-D906072C1A72"></a>measurements from the history <i class="emphasis">h</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">k</i>) we obtain an approximation of <i class="emphasis">m</i><sup>(<i class="emphasis">j</i>)</sup> (1 : <i class="emphasis">k</i> ? 1) that, if, additionally, spatial indices are used to compute the set of relevant scans from <i class="emphasis">h</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">k</i>), can be computed in constant time. Thus, the overall complexity is constant for each particle. This approach has been successfully applied by H<span class="extended-unicode">&#18990;</span>el, Burgard, Fox, and Thrun [181] and has been used for the examples presented here.</p>
<div class="widecontent">
<div class="example">
<span class="example-title"><span class="example-titlelabel">Algorithm 20: </span>Simultaneous localization and mapping using Rao-Blackwellized particle filtering</span><a name="859"></a><a name="ch09al201C14020F-F9F5-4415-973A-D906072C1A72"></a>
<div class="formalbody">
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img alt="Image from book" src="_.gif" width="1" height="2" title="Start example" border="0" /></b></font></td>
</tr>
</table>
<pre class="programlisting">
<b class="bold">Input:</b> Sequence of measurements <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>) and movements <i class="emphasis">u</i>(0 : <i class="emphasis">k</i> - 1) and set <span class="inlinemediaobject"><img alt="Image from book" id="IMG_1376" src="figu343_1.jpg" height="16" width="23" title="" border="0" /></span>
of <i class="emphasis">N</i> samples (<i class="emphasis">x<sub>j</sub></i>, ?<i class="emphasis">j</i>)
<b class="bold">Output:</b> Posterior <i class="emphasis">P</i>(<i class="emphasis">x</i>(1 : <i class="emphasis">k</i>), <i class="emphasis">m</i> | <i class="emphasis">u</i>(0 : <i class="emphasis">k</i> - 1), <i class="emphasis">y</i>(1 : <i class="emphasis">k</i>)) represented by <span class="inlinemediaobject"><img alt="Image from book" id="IMG_1377" src="figu343_2.jpg" height="16" width="23" title="" border="0" /></span> about
the path of the robot at time and the map
1: <b class="bold">for</b> <i class="emphasis">j</i> ? 1 to <i class="emphasis">N</i> <b class="bold">do</b>
2:   <i class="emphasis">x<sub>j</sub></i> ? (0, 0,0)
3: <b class="bold">end for</b>
4: <b class="bold">for</b> <i class="emphasis">i</i> ? 1 to <i class="emphasis">k</i> <b class="bold">do</b>
5:   <b class="bold">for</b> <i class="emphasis">j</i> ? 1 to <i class="emphasis">N</i> <b class="bold">do</b>
6:     compute a new state <i class="emphasis">x</i> by sampling according to <i class="emphasis">P</i>(<i class="emphasis">x</i> | <i class="emphasis">u</i>(<i class="emphasis">i</i> - 1), <i class="emphasis">x<sub>j</sub></i>).
7:     <i class="emphasis">x<sub>j</sub></i> ? <i class="emphasis">x</i>
8:   <b class="bold">end for</b>
9:   ? ? 0
10:   <b class="bold">for</b> <i class="emphasis">j</i> ? 1 to <i class="emphasis">N</i> <b class="bold">do</b>
11:     <i class="emphasis">w<sub>j</sub></i> = <i class="emphasis">P</i>(<i class="emphasis">y</i>(<i class="emphasis">i</i>) | <i class="emphasis">x<sub>j</sub></i>, <i class="emphasis">m</i><sup>(<i class="emphasis">j</i>)</sup>(1 : <i class="emphasis">i</i> - 1)))
12:     ? = ? + <i class="emphasis">w<sub>j</sub></i>
13:   <b class="bold">end for</b>
14:   <b class="bold">for</b> <i class="emphasis">j</i> ? 1 to <i class="emphasis">N</i> <b class="bold">do</b>
15:     <i class="emphasis">w<sub>j</sub></i> = ?<sup>-1</sup> <i class="emphasis">w<sub>j</sub></i>
16:   <b class="bold">end for</b>
17:   <span class="inlinemediaobject"><img alt="Image from book" id="IMG_1378" src="figu343_3.jpg" height="19" width="166" title="" border="0" /></span>
18: <b class="bold">end for</b>
</pre>
<table class="BlueLine" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td bgcolor="000080" class="bluecell"><font size="2" face="Arial" color="010100"><b><img alt="Image from book" src="_.gif" width="1" height="2" title="End example" border="0" /></b></font></td>
</tr>
</table>
<table class="BlankSpace" border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td height="16"></td>
</tr>
</table>
</div>
</div>
</div>
<p class="para">A further aspect which turns out to be crucial to the success of the overall approach is the limitation of the number of particles that are needed. Since each particle possesses an individual map, the memory required by using Rao-Blackwellized filtering can be quite high, especially if many samples are needed to appropriately represent the posterior. One technique to reduce the number of necessary samples has recently been developed by H<span class="extended-unicode">&#18990;</span>el et al. [181]. In their approach consecutive laser range scans are converted into highly accurate odometry measurements. This way the uncertainty in the location of the robot is reduced so that fewer samples are needed to represent the posterior.</p>
<p class="para">
<a name="860"></a><a name="IDX-3441C14020F-F9F5-4415-973A-D906072C1A72"></a><a class="internaljump" href="#ch09fig221C14020F-F9F5-4415-973A-D906072C1A72">Figure 9.22</a> shows a Rao-Blackwellized particle filter for simultaneous localization and mapping in action. The individual figures illustrate the posterior about the robot's location as well as the map associated with the particle with the maximum accumulated importance factor. Image (a) shows the belief of the robot just before the robot is closing a loop. The second image (b) depicts the belief some steps later after the robot has closed the loop. As can be seen, the belief is more peaked due to the fact that particles whose observations do not match to their maps quickly die out when a loop is closed. Picture (c) shows a situation when the robot has moved around the loop for a second time. Please note that all figures also show the paths of all particles. Alow number of different paths indicates that at the corresponding point in time, already many particles have a common history. In the situation depicted in image (d) the robot has visited all rooms in the building and enters a new corridor which imposes the task of closing another loop. The belief shortly before the robot closes this second loop is depicted in image (e). Image (f) shows the map and the particle histories after the robot finished its task. The resulting map is illustrated in <a class="internaljump" href="#ch09fig231C14020F-F9F5-4415-973A-D906072C1A72">figure 9.23</a>.</p>
<div class="figure">
<a name="861"></a><a name="ch09fig221C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1379','fig9-22_0.jpg','1000','526')" name="IMG_1379" target="_self"><img alt="Image from book" id="IMG_1379" src="fig9-22.jpg" height="184" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.22: </span>Sequence of maps corresponding to the particle with the highest accumulated importance weight during Rao-Blackwellized particle filtering of a large cyclic environment.</span>
</div>
<div class="figure">
<a name="862"></a><a name="ch09fig231C14020F-F9F5-4415-973A-D906072C1A72"></a><span class="figuremediaobject"><a href="javascript:PopImage('IMG_1380','fig9-23_0.jpg','1000','801')" name="IMG_1380" target="_self"><img alt="Image from book" id="IMG_1380" src="fig9-23.jpg" height="280" width="350" title="Click To expand" border="0" /></a></span>
<br style="line-height: 1" />
<span class="figure-title"><span class="figure-titlelabel">Figure 9.23: </span>Resulting map obtained with Rao-Blackwellized particle filtering for SLAM.</span>
</div>
<p class="last-para">After they have been demonstrated to be an efficient means for SLAM [137,329], Rao-Blackwellized particle filters have been used with great success to learn large-scale maps of different types of environments. For example, Montemerlo et al. [321] have applied this technique to landmark-based mapping in which the locations of the individual landmarks are represented by Gaussians. In a more recent work [320] Montemerlo and Thrun extended this work to landmark-based mapping with uncertain <a name="863"></a><a name="IDX-3451C14020F-F9F5-4415-973A-D906072C1A72"></a>data association. Additionally, this technique has been applied successfully to the simultaneous estimation of states of dynamic objects and the robot's locations [32, 322]. As mentioned above, new results present optimizations of this technique that allow the efficient application of Rao-Blackwellized particle filtering to SLAM with raw laser range scans [181,346].</p>
</div>
</div>
</div>
</div>
</div><table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td colspan="3" height="5"><img src="images/_.gif" width="1" alt="" border="0" height="5" /></td>
</tr>
<tr>
<td class="b24-chunknavigate" width="25%" align="left"><a border="0" accesskey="P" href="54.html"><img src="images/arrow_readprevious.gif" width="94" height="22" hspace="0" alt="Previous Section" title="Previous Section" border="0" /></a></td>
<td class="b24-chunknavigate" width="75%" align="center">
<table cellpadding="0" cellspacing="0" border="0">
</table>
</td>
<td class="b24-chunknavigate" width="25%" align="right"><a border="0" href="viewer.asp?bookid=10749&amp;chunkid=703155035"><img width="1" height="1" hspace="1" border="0" alt="" src="images/_.gif" /></a><a border="0" accesskey="N" href="56.html"><img src="images/arrow_readnext.gif" width="94" height="22" hspace="0" alt="Next Section" title="Next Section" border="0" /></a></td>
</tr>
<tr>
<td colspan="3" height="5"><img src="images/_.gif" width="1" alt="" border="0" height="5" /></td>
</tr>
</table>
<table border="0" cellspacing="0" cellpadding="0" width="100%" bgcolor="#FFFFFF" height="50">
<tr><td bgcolor="#000000"><img src="images/_.gif" width="1" height="1" alt="" border="0" /></td></tr>
<tr><td><?xml version='1.0' encoding='utf-8'?><table border="0" width="100%" cellspacing="0" cellpadding="0"><tr><td width="99%" valign="Top" class="footer"><b>TeamUnknown Release</b></td></tr></table></td></tr>
<div id="download" class="b24-download_bubble"></div>
</table></body>
</html>
